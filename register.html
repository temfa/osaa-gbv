<!DOCTYPE html>
<html lang="zxx">
  <head>
    <title>OSAA-GBV e-learning | Register Form</title>
    <!-- Meta tag Keywords -->
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="UTF-8" />
    <meta name="keywords" content="OSAA-GBV e-learning" />
    <script>
      addEventListener(
        "load",
        function () {
          setTimeout(hideURLbar, 0);
        },
        false
      );

      function hideURLbar() {
        window.scrollTo(0, 1);
      }
    </script>
    <!--// Meta tag Keywords -->

    <!-- Custom-Files -->
    <!-- Bootstrap-Core-Css -->
    <link rel="stylesheet" href="css/bootstrap.css" />
    <!-- Style-Css -->
    <link rel="stylesheet" href="css/style.css" type="text/css" media="all" />
    <!-- Font-Awesome-Icons-Css -->
    <link rel="stylesheet" href="css/fontawesome-all.css" />
    <!-- //Custom-Files -->

    <!-- Web-Fonts -->
    <link
      href="//fonts.googleapis.com/css?family=Roboto+Condensed:300,300i,400,400i,700,700i&amp;subset=cyrillic,cyrillic-ext,greek,greek-ext,latin-ext,vietnamese"
      rel="stylesheet" />
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i" rel="stylesheet" />
    <!-- //Web-Fonts -->
  </head>

  <body>
    <!-- header -->
    <header>
      <!-- top header -->
      <div class="top-head-w3ls py-2 bg-dark" id="top-header"></div>
      <!-- //top header -->
      <!-- middle header -->
      <div class="middle-w3ls-nav py-2" id="header"></div>
      <!-- //middle header -->
    </header>
    <!-- //header -->

    <!-- banner -->
    <div class="banner-agile-2">
      <!-- navigation -->
      <div class="navigation-w3ls">
        <nav class="navbar navbar-expand-lg navbar-light bg-light sticky-nav">
          <button
            class="navbar-toggler mx-auto"
            type="button"
            data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse text-center" id="navbarSupportedContent"></div>
        </nav>
      </div>
      <!-- //navigation -->
    </div>
    <!-- breadcrumb -->
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="index.html">Home</a>
        </li>
        <li class="breadcrumb-item active" aria-current="page">Register Form</li>
      </ol>
    </nav>
    <!-- breadcrumb -->
    <!-- //banner -->

    <!-- register -->
    <div class="login-w3ls py-5">
      <div class="container py-xl-5 py-lg-3">
        <h3 class="title text-capitalize font-weight-light text-dark text-center mb-5">
          register
          <span class="font-weight-bold">now</span>
        </h3>
        <!-- content -->
        <div class="sub-main-w3 pt-md-4">
          <form id="register-form">
            <div class="form-style-agile form-group">
              <label>
                Your Name
                <i class="fas fa-user"></i>
              </label>
              <input placeholder="Your Name" class="form-control" name="fullName" type="text" id="fullName" required="" />
              <small></small>
            </div>
            <div class="form-style-agile form-group">
              <label>
                Email
                <i class="fas fa-envelope"></i>
              </label>
              <input placeholder="Email" class="form-control" name="Email" type="email" id="email" required="" />
              <small></small>
            </div>
            <div class="form-style-agile form-group">
              <label>
                Organisation
                <i class="fas fa-globe"></i>
              </label>
              <input placeholder="Organisation" class="form-control" name="organisation" id="organisation" type="text" required="" />
              <small></small>
            </div>
            <div class="form-style-agile form-group">
              <label>
                Role in the Organisation
                <i class="fas fa-globe"></i>
              </label>
              <input placeholder="Role in the Organisation" class="form-control" name="role" type="text" id="role" required="" />
              <small></small>
            </div>
            <div class="form-style-agile form-group">
              <label>
                Password
                <i class="fas fa-unlock-alt"></i>
              </label>
              <input placeholder="Password" class="form-control" name="Password" id="password1" type="password" required="" />
              <small></small>
            </div>
            <div class="form-style-agile form-group">
              <label>
                Confirm Password
                <i class="fas fa-unlock-alt"></i>
              </label>
              <input placeholder="Confirm Password" class="form-control" name="Confirm Password" id="password2" type="password" required="" />
              <small></small>
            </div>
            <!-- switch -->
            <!-- <ul class="list-unstyled list-login">
              <li class="switch-agileits float-left">
                <label class="switch text-capitalize">
                  <input type="checkbox" />
                  <span class="slider-switch slider-switch-2 round"></span>
                  I Accept to the Terms & Conditions
                </label>
              </li>
            </ul> -->
            <!-- //switch -->
            <div id="loader"></div>
            <input type="submit" value="Register" id="regsiter-btn" />
          </form>
        </div>
        <!-- //content -->
      </div>
    </div>
    <!-- //register -->

    <!-- footer -->
    <footer id="footer"></footer>
    <!-- //footer -->

    <!-- Js files -->
    <!-- JavaScript -->
    <script src="js/jquery-2.2.3.min.js"></script>
    <script src="js/script.js"></script>
    <!-- Default-JavaScript-File -->
    <script src="js/bootstrap.js"></script>
    <!-- Necessary-JavaScript-File-For-Bootstrap -->

    <!-- password-script -->
    <script>
      window.onload = function () {
        document.getElementById("password1").onchange = validatePassword;
        document.getElementById("password2").onchange = validatePassword;
      };

      function validatePassword() {
        var pass2 = document.getElementById("password2").value;
        var pass1 = document.getElementById("password1").value;
        if (pass1 != pass2) document.getElementById("password2").setCustomValidity("Passwords Don't Match");
        else document.getElementById("password2").setCustomValidity("");
        //empty string means no validation error
      }
    </script>
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-app.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries

      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyDHzVV8RamHhjgbyofIQorBoS6UWgBucTk",
        authDomain: "osaa-gbv.firebaseapp.com",
        projectId: "osaa-gbv",
        storageBucket: "osaa-gbv.appspot.com",
        messagingSenderId: "880792047435",
        appId: "1:880792047435:web:a370e0e414cd879d96e2ce",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const authentication = getAuth();
      import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-auth.js";
      import { getDatabase, ref, set, child, get, update, remove } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-database.js";
      let fullName = document.getElementById("fullName");
      let email = document.getElementById("email");
      let organisation = document.getElementById("organisation");
      let role = document.getElementById("role");
      let password1 = document.getElementById("password1");
      let password2 = document.getElementById("password2");
      const realdb = getDatabase();

      let register = document.getElementById("register-form");
      let registerBtn = document.getElementById("register-btn");
      let loader = document.getElementById("loader");
      register.addEventListener("submit", (e) => {
        e.preventDefault();
        registerBtn.style.display = "none";
        loader.style.display = "block";
        if (!validation()) {
          alert("Error");
          registerBtn.style.display = "block";
          loader.style.display = "none";
        } else {
          registerProcess();
        }
      });

      const validation = () => {
        let productRegex = /^[0-9]+$/;
        if (fullName.value === "") {
          setErrorFor(fullName, "Full name cannot be empty");
        } else if (productRegex.test(fullName.value)) {
          setErrorFor(fullName, "Full Name can only be alphabelt");
        }
        if (organisation.value === "") {
          setErrorFor(organisation, "Full name cannot be empty");
        } else if (productRegex.test(organisation.value)) {
          setErrorFor(organisation, "Full Name can only be alphabelt");
        }
        if (role.value === "") {
          setErrorFor(role, "Full name cannot be empty");
        } else if (productRegex.test(role.value)) {
          setErrorFor(role, "Full Name can only be alphabelt");
        }
        return true;
      };
      const clearInputs = () => {
        fullName.value = "";
        email.value = "";
        organisation.value = "";
        role.value = "";
        password1.value = "";
        password2.value = "";
      };

      const registerProcess = (e) => {
        createUserWithEmailAndPassword(authentication, email.value, password1.value)
          .then((response) => {
            // sessionStorage.setItem("Auth Token", response._tokenResponse.refreshToken);
            set(ref(realdb, "users/" + response.user.uid), {
              id: response.user.uid,
              fullName: fullName.value,
              email: email.value,
              organisation: organisation.value,
              role: role.value,
              password1: password1.value,
              module1: 0,
              module1Done: false,
              module2: 0,
              module2Done: false,
              module3: 0,
              module3Done: false,
              module4: 0,
              module4Done: false,
              module5: 0,
              module5Done: false,
              module6: 0,
              module6Done: false,
            });
            clearInputs();
            alert("Created Successfully");
            window.scrollTo(0, 1);
            registerBtn.style.display = "block";
            loader.style.display = "none";
            window.location.href = "login.html";
          })
          .catch((error) => {
            console.log(error);
            registerBtn.style.display = "block";
            loader.style.display = "none";
            if (error.code === "auth/email-already-in-use") {
              alert("Email Already in Use");
            }
            if (error.code === "auth/weak-password") {
              alert("You have a weak password");
            }
          });
      };

      function setErrorFor(input, message) {
        let forms = input.parentElement.parentElement;

        forms.classList = "form-group error";
        let small = forms.querySelector("small");
        small.innerText = message;
      }
    </script>
    <!-- //password-script -->

    <!-- smooth scrolling -->
    <script src="js/SmoothScroll.min.js"></script>
    <!-- //smooth scrolling -->

    <!-- move-top -->
    <script src="js/move-top.js"></script>
    <!-- easing -->
    <script src="js/easing.js"></script>
    <!--  necessary snippets for few javascript files -->
    <script src="js/edulearn.js"></script>

    <!-- //Js files -->
  </body>
</html>
